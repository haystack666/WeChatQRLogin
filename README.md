<div align="center">

<div style="width: 30;>

[![haystack666/WeChatQRLogin](https://haydata-cd.oss-cn-chengdu.aliyuncs.com/github/WeChatQRLogin/WeChatQRLogin-logo.png?x-oss-process=style/WeChatQRLogin_image_small)](https://github.com/haystack666/WeChatQRLogin)

</div>

</div>

<h1 align="center">WeChatQRLogin</h1>

## é¡¹ç›®ä»‹ç»

ç½‘é¡µä¸­ä½¿ç”¨å¾®ä¿¡å…¬ä¼—å·çš„å¾®ä¿¡æ‰«ç ç™»å½•ï¼Œã€ä¸‹è½½å³å¯ç”¨ã€‘çš„å¾®ä¿¡å…¬ä¼—å·çš„å¾®ä¿¡æ‰«ç ç™»å½•ï¼Œä½¿ç”¨å¾®ä¿¡å®˜æ–¹æ¥å£ä»¥åŠç¾å›¾IPåœ°å€çš„APIï¼Œä¸å¤¹å¸¦ä»»ä½•ç§è´§ï¼Œè¯·æ”¾å¿ƒä½¿ç”¨ğŸ˜…ï¼ï¼ï¼

## å…±åŒå¼€å‘

æ¬¢è¿å„ä½æœ‹å‹éšæ—¶æé—®ï¼Œè®©WeChatQRLoginå˜å¾—æ›´ç®€å•å¥½ç”¨ï¼å¦‚æœä½ æœ‰æ–°çš„æƒ³æ³•ï¼Œä¹Ÿæ¬¢è¿åé¦ˆã€‚

## åŠŸèƒ½ç‰¹æ€§

- [x] åŒ…å«æ³¨å†Œä»£ç ï¼ˆåŒ…å«é˜²æ­¢é‡å¤æ³¨å†Œï¼‰ï¼Œä½¿ç”¨MySQLè®°å½•æ³¨å†Œç”¨æˆ·ä¿¡æ¯ä»¥åŠç™»å½•æ—¥å¿—
- [x] æœªå…³æ³¨ç”¨æˆ·æ‰«ç å¹¶å…³æ³¨å…¬ä¼—å·åä¹Ÿèƒ½æ­£å¸¸æ³¨å†Œç™»å½•

## TODO

- [ ] æ ¹æ®æµè§ˆå™¨UAè¿”å›æ­£ç¡®çš„æ ‡è¯†

## æ³¨æ„äº‹é¡¹

1. ä½ éœ€è¦å¼€é€š[ã€å¾®ä¿¡å…¬ä¼—å¹³å°-æ–°çš„åŠŸèƒ½-æ¨¡æ¿æ¶ˆæ¯ã€‘](https://developers.weixin.qq.com/doc/offiaccount/Message_Management/Template_Message_Interface.html)ã€‚
2. è¯·ç¡®ä¿**å¾®ä¿¡å…¬ä¼—å¹³å°-è®¾ç½®ä¸å¼€å‘-æ¥å£æƒé™**ä¸­æ‰€æœ‰æ¥å£å‡å·²å¼€é€šä¸”åº”æœ‰é…ç½®å·²å…¨éƒ¨è®¾ç½®ã€‚

>**è·å–access_token**
>
>![haystack666/WeChatQRLogin](https://haydata-cd.oss-cn-chengdu.aliyuncs.com/github/WeChatQRLogin/WeChatQRLogin-access_token.png)

---

>**ç”Ÿæˆå¸¦å‚æ•°çš„äºŒç»´ç **
>
>![haystack666/WeChatQRLogin](https://haydata-cd.oss-cn-chengdu.aliyuncs.com/github/WeChatQRLogin/WeChatQRLogin-createQRCode.png)

---

>**è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯**
>
>![haystack666/WeChatQRLogin](https://haydata-cd.oss-cn-chengdu.aliyuncs.com/github/WeChatQRLogin/WeChatQRLogin-getUserInfo.png)

---

>**ç½‘é¡µæˆæƒè·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯**
>
>![haystack666/WeChatQRLogin](https://haydata-cd.oss-cn-chengdu.aliyuncs.com/github/WeChatQRLogin/WeChatQRLogin-webGetInfo.png)
ç‚¹å‡»åé¢çš„**ä¿®æ”¹**
â¬‡ï¸â¬‡ï¸â¬‡ï¸â¬‡ï¸â¬‡ï¸
>**ç½‘é¡µæˆæƒåŸŸå**
>
>![haystack666/WeChatQRLogin](https://haydata-cd.oss-cn-chengdu.aliyuncs.com/github/WeChatQRLogin/WeChatQRLogin-bindDomain.png)

---

>**å¾®ä¿¡å…¬ä¼—å¹³å°-è®¾ç½®ä¸å¼€å‘-åŸºæœ¬é…ç½®-æœåŠ¡å™¨é…ç½®**
>
>![haystack666/WeChatQRLogin](https://haydata-cd.oss-cn-chengdu.aliyuncs.com/github/WeChatQRLogin/WeChatQRLogin-TokenVerification.png)



## ä½¿ç”¨æ–¹æ³•

**ä¸‹è½½é¡¹ç›®åˆ°æœ¬åœ°ï¼Œæ›´æ”¹å…¶ä¸­æŸäº›æ–‡ä»¶çš„ä¸€äº›ä»£ç å³å¯**

WeChat.class.phpï¼š

```php
protected $appid = "YOUR-APPID"; //æ”¹ä¸ºä½ çš„appid
protected $secret = "YOUR-SECRET"; //æ”¹ä¸ºä½ çš„secret
...
...
$this->mysqli = new mysqli('ä¸»æœºåœ°å€','ç”¨æˆ·å','å¯†ç ','æ•°æ®åº“å'); //æ”¹ä¸ºä½ çš„æ•°æ®åº“ç›¸å…³ä¿¡æ¯
```

åˆ›å»ºè¡¨

```sql
CREATE TABLE IF NOT EXISTS wechat_users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    openid VARCHAR(50) NOT NULL UNIQUE,
    nickname VARCHAR(50) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS login_records (
    id INT AUTO_INCREMENT PRIMARY KEY,
    openid VARCHAR(50) NOT NULL,
    login_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    ip VARCHAR(50),
    user_agent TEXT,
    login_location TEXT,
    event_key VARCHAR(50)
);

```

# ç»“æŸ
**è‡³æ­¤ï¼Œä¸å‡ºæ„å¤–ä½ åº”è¯¥å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ï¼Œå¦‚æœæˆ‘æ–‡æ¡£ä¸­æ¼æ‰äº†ä»€ä¹ˆåœ°æ–¹ï¼Œè¯·æŒ‡æ­£ï¼**
